var dirtyKillsArray = [['68483', 'Palo_Racing_', 'Hc-LuanRenato'],['69216', 'Ogt.Juniu', 'L1ght._.'],['73164', 'NewbieNSS', 'Fåcu1512'],['73830', 'jorge246810', 'Andres17dorado'],['75931', 'arriagaagus', 'NewbieNSS'],['78398', 'SrJohanXpL', 'SrJohanXpL'],['83523', 'Khyora7', 'Khyora7'],['84790', 'Pumped by Cons', 'Zicrooo'],['89657', 'Ly EoS', 'M4zok_FnX'],['91424', 'the fezinho', 'Ogt.Juniu'],['93191', 'MND_Ju4NConde3', 'TWITCH_DARK1REX'],['100525', 'ThEgAbRiElUs', 'ThEgAbRiElUs'],['104392', 'AnthonyElCrackxd', 'cocomessi12'],['104426', 'joako007akd', 'Yensos'],['106026', 'JojiChil', 'Dark rise 09'],['107692', 'Proheremy', 'ShadowGhostBR15'],['108092', 'joako007akd', 'martinPREDATOR72'],['108192', 'Ly EoS', 'Ðмх_ФмêgâЦиКфифш'],['111759', 'Palo_Racing_', 'vyujbhftybgyug'],['114492', 'MND_Ju4NConde3', 'winililipu'],['120226', 'faze gus_xd', 'd4N1el_4_o'],['120393', 'DJiverson7', 'Minimal Monkey'],['122904', 'AE_xShawiis', 'STG_Yonix'],['124971', 'Ma Ninja_', 'Ma Ninja_'],['125005', 'SHONPOL2000', 'AbsoladoMaluko'],['127905', 'MND_Ju4NConde3', 'BK-BuNdaMoLe'],['129205', 'TTVbugs', 'the fezinho'],['131772', 'TM_carlosT16', 'Թａｐｅｅｒηт'],['136913', 'joako007akd', 'EstefanoTeamPeru'],['136913', 'Kаtаkuri', 'OAlexisO'],['137080', 'AnthonyElCrackxd', 'Ly EoS'],['138447', 'jorge246810', 'Palo_Racing_'],['139281', 'Pumped by Cons', 'joako007akd'],['139581', 'Josue_o_Motoboy3', '黒い孤独な戦士'],['147532', 'JeanPoo1', 'arriagaagus'],['151134', 'zErivas', 'bYspox'],['157305', 'DV4 MR9ツ', 'DV4 MR9ツ'],['157939', 'AℜℕﾼẔ5', 'faze gus_xd'],['161606', 'blueberry hamㅤ', 'blueberry hamㅤ'],['161773', 'TM_carlosT16', 'Kаtаkuri'],['163740', 'BenjitaRico2007', 'BenjitaRico2007'],['165307', 'CHUCKY_DAV1L4_', 'JULIAN AA'],['170008', 'julianmacagno687', 'Vitorns14'],['172509', 'Only Kid Player', 'Twitch CA_Lord14'],['184645', 'keothekidjajaja', 'SHONPOL2000'],['186112', 'julianmacagno687', 'FELPS2005'],['190480', 'janox matatan', 'poter97'],['191614', 'DJiverson7', 'Fefefraca21'],['204616', 'Pumped by Cons', 'AnthonyElCrackxd'],['205050', 'BA.Hiroto', 'keothekidjajaja'],['223387', 'DARK MASTERS 26', 'TM_carlosT16'],['225088', 'AE_xShawiis', 'Josue_o_Motoboy3'],['228289', 'Mr.Kirasz', 'XZ2000KILL'],['228889', 'DJiverson7', 'Dorminxdx'],['234423', 'Only Kid Player', 'Maööri'],['243459', 'AE_xShawiis', 'Algemirouuu'],['244659', 'Proheremy', 'MND_Ju4NConde3'],['250668', 'JojiChil', 'jorge246810'],['254902', 'Topovich_', 'Sniped by dino.'],['272932', 'BA.Hiroto', 'PacocaI EZS'],['280297', 'FulKaka', 'JhonyBoyola'],['281463', 'Proheremy', 'JojiChil'],['286962', 'DARK MASTERS 26', 'AndreOliveira070'],['295860', 'DS Ruled by Samu', 'Pumped by Cons'],['335332', 'CHUCKY_DAV1L4_', '4i20 Scorpion'],['360576', 'CHUCKY_DAV1L4_', 'BA.Hiroto'],['364275', 'DS Ruled by Samu', 'JagvirXx'],['373019', 'JeanPoo1', 'Proheremy'],['383317', 'isaacfebresxd', 'soy el noob'],['421277', 'TTVbugs', 'peterlaime'],['427275', 'DJiverson7', 'vicente2009lol'],['447605', 'AℜℕﾼẔ5', 'julianmacagno687'],['448340', 'eliseopingon', 'srnoob03'],['476919', 'eliseopingon', 'JeanPoo1'],['503767', 'isaacfebresxd', 'jorge mvc'],['518830', 'AℜℕﾼẔ5', 'AE_xShawiis'],['532827', 'Mr.Kirasz', 'zErivas'],['553940', 'Topovich_', 'AℜℕﾼẔ5'],['609750', 'eliseopingon', 'GABRIELMENEZES10'],['619468', 'DS Ruled by Samu', 'janox matatan'],['631549', 'isaacfebresxd', 'TTVbugs'],['661191', 'eliseopingon', 'TSM_P13RO'],['675052', 'NYCKGAMER123', 'HwK ROMANOJOGA'],['677118', 'DJiverson7', 'FulKaka'],['690285', 'CHUCKY_DAV1L4_', 'cristhianxxd31'],['696350', 'DS Ruled by Samu', 'Topovich_'],['751493', 'Mr.Kirasz', 'eliseopingon'],['806538', 'Only Kid Player', 'NYCKGAMER123'],['876537', 'Mr.Kirasz', 'Mr.Kirasz'],['920750', 'Only Kid Player', 'Raelzzin'],['1022092', 'DS Ruled by Samu', 'isaacfebresxd'],['1044429', 'DJiverson7', 'CHUCKY_DAV1L4_'],['1046196', 'DJiverson7', 'DJiverson7'],['1081221', 'DS Ruled by Samu', 'DARK MASTERS 26'],['1129742', 'Only Kid Player', 'DS Ruled by Samu'],['1148103', 'Only Kid Player', 'Only Kid Player']]; // partida en solitario

var killsArray = [];
var position = {};
var length = dirtyKillsArray.length;
for (let i = 0; i < dirtyKillsArray.length; i++) {
    if(dirtyKillsArray[i][1] != dirtyKillsArray[i][2]) { //remove auto-eliminations
        var flag = false;
        for (let j = i + 1; j < dirtyKillsArray.length; j++) {
            //if see a loop between two nodes with other dataset, add comparison with dirtyKillsArray[i][0] too
            //this if is for remove knock and eliminations in duo o squad games
            if(dirtyKillsArray[i][1] == dirtyKillsArray[j][1] && dirtyKillsArray[i][2] == dirtyKillsArray[j][2]) 
                flag = true;
        }
        if(!flag)
            killsArray.push(dirtyKillsArray[i]);
    }
    //sets position to every player according to inverse elimination order(assuming that the array comes ordered). Maths are for correct position and index with actual index values and array length
    position[dirtyKillsArray[length - i - 1][2]] = i + 1; 
}

var killsArrayNames = {};
for (let i = 0; i < killsArray.length; i++) {
    killsArrayNames[killsArray[i][1]] = true; //replace killsArray to dirtyKillsArray to see auto-elimations. Research if a array [['julianmacagno'],['julianmacagno']] is a elim
    killsArrayNames[killsArray[i][2]] = true;
}
var playersName = Object.keys(killsArrayNames);

var nodes = playersName.map(function(name) {
    return {id: name, label: position[name] + " - " + name, position: position[name], level: 7};
});

for (let i = 0; i < nodes.length; i++) {
    if(nodes[i].id == 'Only Kid Player')
        nodes[i].level = 1;
}

for (let level = 1; level < 7; level++) {
    for (let i = 0; i < nodes.length; i++) {
        if(nodes[i].level == level) { //busca los de ese nivel por vez
            for (let j = 0; j < killsArray.length; j++) { 
                if(nodes[i].id == killsArray[j][1]) {  //busca la kills de los de ese nivel
                    for (let k = 0; k < nodes.length; k++) { //con la kill, busca en node los que hayan sido matados por el de arriba
                        if(nodes[k].id == killsArray[j][2]) {
                            nodes[k].level = level+1;
                        }
                    }
                }
            }
        }
    }
}

var edges = killsArray.map(function(killEvent) {
    return {from: killEvent[1], to: killEvent[2]}; //kill[1] is killer, kill[2] is killed
});

var container = document.getElementById('visualization');
var data = {
    nodes: nodes,
    edges: edges
};

var options = {
    edges:{
        arrows: {
            from:   {enabled: false, scaleFactor:1.3, type:'arrow'},
            to:     {enabled: true, scaleFactor:1.3, type:'arrow'}
        }
    },
    physics:{
        enabled: true
    },
    layout: {
        randomSeed: undefined,
        improvedLayout:true,
        hierarchical: {
          enabled:true,
          levelSeparation: 150,
          nodeSpacing: 100,
          treeSpacing: 200,
          blockShifting: true,
          edgeMinimization: true,
          parentCentralization: true,
          direction: 'UD',        // UD, DU, LR, RL
          sortMethod: 'hubsize'   // hubsize, directed
        }
    }
}

var network = new vis.Network(container, data, options);
network.setSize(document.documentElement.clientWidth, document.documentElement.clientHeight);